## Структура файла views.py

### User
* class RegisterAccount(APIView): path: user/register
 
    Класс для регистрации новых пользователей. 
    Позволяет создать учетную запись пользователя с проверкой сложности пароля и уникальности данных.
  
* class ConfirmAccount(APIView): path: user/register/confirm

    Класс для подтверждения почтового адреса пользователя после регистрации

* class LoginAccount(APIView): path: user/login

    Класс для авторизации пользователей.


* class ChangeUserType(APIView): path: user/change/type

    Позволяет аутентифицированному пользователю переключаться 
    между типами 'buyer' и 'shop'

* class ContactView(APIView): path: user/contact

    Класс для управления контактной информацией пользователя

* class AccountDetails(APIView): path: user/details

    Класс для управления деталями аккаунта пользователя

### Partner
* class PartnerUpdate(APIView): path: partner/update

    Класс для обновления информации о партнерах (магазинах) и их продуктах

* class PartnerState(APIView): path: partner/state

    Класс для управления статусом партнера (магазина)

* class PartnerOrders(APIView): path: partner/orders

    Класс для получения заказов, связанных с аутентифицированным партнером (магазином)


### Shop
* class ShopView(ListAPIView): path: shops

    Класс для просмотра списка магазинов. Отображает только активные магазины.

* class ProductInfoView(APIView): path: products

    Класс для поиска и отображения информации о продуктах.

* class BasketView(APIView): path: basket

    Класс для управления корзиной пользователя

* class OrderView(APIView): path: order

    Класс для управления заказами пользователя

* class CategoryView(ListAPIView): path: categories

    Класс для просмотра списка категорий.

## User class
### class RegisterAccount(APIView):  path: user/register
    Класс для регистрации новых пользователей. 
    Позволяет создать учетную запись пользователя с проверкой сложности пароля и уникальности данных.

    Методы:
    **post(request, *args, kwargs):
        Обрабатывает POST-запрос для создания нового пользователя. Проверяет наличие всех необходимых полей и сохраняет пользователя в базе данных.

    Ожидаемые данные:
    first_name (str): Имя пользователя.
    last_name (str): Фамилия пользователя.
    email (str): Электронная почта пользователя.
    password (str): Пароль пользователя.
    company (str): Компания пользователя.
    position (str): Должность пользователя.

    Ответы:
        В случае успешного создания учетной записи возвращает HTTP-статус 201.

    400 Bad Request:
    {'Status': False, 'Errors': {'password': [...]}}: В случае ошибки валидации пароля.
    
    {'Status': False, 'Errors': {'...'}}: В случае ошибки в других полях.
    ConfirmAccount (APIView)

### ConfirmAccount (APIView): path: user/register/confirm
    Класс для подтверждения почтового адреса пользователя после регистрации

    Методы:
    **post(request, *args, kwargs):
    Обрабатывает POST-запрос для подтверждения почтового адреса на основе отправленного токена. Если токен указан верно, учетная запись пользователя активируется.

    Ожидаемые данные:
        email (str): Электронная почта пользователя.
        token (str): Токен подтверждения, отправленный на почту.

    Ответы:
        В случае успешного подтверждения почтового адреса возвращает HTTP-статус 200.

        HTTP-статус 400 Bad Request:
    {'Status': False, 'Errors': 'Неправильно указан токен или email'}: В случае ошибки подтверждения.

    {'Status': False, 'Errors': 'Не указаны все необходимые аргументы'}: Если не все обязательные аргументы переданы.

### LoginAccount (APIView): path: user/login
    Класс для авторизации пользователей. Позволяет аутентифицировать пользователя и вернуть токен для дальнейшей работы с API.
    При успешной авторизации токен отправляется пользователю на указанный email.

    Методы:
    post(request, *args, kwargs):
        Обрабатывает POST-запрос для аутентификации пользователя по email и паролю. В случае успешной аутентификации возвращает токен для доступа к API.

    Ожидаемые данные:
        email (str): Электронная почта пользователя.
        password (str): Пароль пользователя.

    Ответы:
    В случае успешной аутентификации возвращает HTTP-статус 200 и токен для доступа к API.

    400 Bad Request:
    {'Status': False, 'Errors': 'Не удалось авторизовать'}: В случае ошибки аутентификации.

    {'Status': False, 'Errors': 'Не указаны все необходимые аргументы'}: Если не все обязательные аргументы переданы.


### ChangeUserType (APIView): path: user/change/type
    Класс для изменения типа пользователя. Позволяет аутентифицированному пользователю переключаться 
    между типами 'buyer' и 'shop', при этом требуется ввод текущего пароля для подтверждения действия.
    (Authorization Token: {auth_token})

    Методы:
    **post(request, *args, kwargs):

    Ожидаемые данные:
    password (str): Текущий пароль пользователя.

    Ответы:
    В случае успешной смены типа пользователя возвращается JSON-ответ с ключом 'Status' и значением True, а также ключом 'Message' с информацией о том, какой тип пользователя установлен.

    В случае ошибки (например, если пароль неверен или не предоставлен), возвращается JSON-ответ с ключом 'Status' и значением False, а также описанием ошибки.

### ContactView (APIView): path: user/contact
    Класс для управления контактной информацией пользователя. Позволяет просматривать, добавлять, обновлять и удалять контакты аутентифицированного пользователя.
    (Authorization Token: {auth_token})

    Методы:
    Метод GET:
    **get(request, *args, kwargs):
    Обрабатывает GET-запрос для получения контактной информации аутентифицированного пользователя.

    Ответы:
    В случае успешного получения контактной информации возвращает JSON-ответ с данными контактов и HTTP-статус 200.

    Если пользователь не аутентифицирован, возвращает HTTP-статус 403 с сообщением 'Log in required'.

    Метод POST:
    **post(request, *args, kwargs):
    Обрабатывает POST-запрос для создания нового контакта для аутентифицированного пользователя.
    В запросе должны быть указаны все необходимые поля. Если какого-то из них нет, возвращается ошибка.
    Необходимые поля: city, street, phone.

    Ожидаемые данные:
    city: Название города.
    street: Название улицы.
    house: Номер дома.
    structure: Строение.
    building: Корпус.
    apartment: Квартира.
    phone: Номер телефона.

    Ответы:
    В случае успешного создания нового контакта возвращает JSON-ответ с ключом 'Status' и значением True.

    Если данные невалидны, возвращает JSON-ответ с ключом 'Status' и значением False, а также деталями ошибок.

    Если не указаны все необходимые аргументы, возвращается JSON-ответ с ключом 'Status' и значением False, и сообщением об ошибке.

    Метод PUT:
    *put(request, *args, kwargs):
    Обрабатывает PUT-запрос для обновления контактной информации аутентифицированного пользователя.
    Если указанный контакт существует и принадлежит текущему пользователю, данные обновляются.

    Если контакт с указанным id не найден или не принадлежит пользователю, возвращается ошибка.

    Ожидаемые данные:
    city: Название города.
    street: Название улицы.
    house: Номер дома.
    structure: Строение.
    building: Корпус.
    apartment: Квартира.
    phone: Номер телефона.

    Ответы:
    В случае успешного обновления возвращает JSON-ответ с ключом 'Status' и значением True.

    Если данные невалидны, возвращает JSON-ответ с ключом 'Status' и значением False, а также деталями ошибок.

    Если не указаны все необходимые аргументы, возвращает JSON-ответ с ключом 'Status' и значением False, и сообщением об ошибке.

    Метод DELETE:
    **delete(request, *args, kwargs):
    Обрабатывает DELETE-запрос для удаления контактов аутентифицированного пользователя.
    Удаляются только те контакты, которые принадлежат текущему пользователю и идентификаторы которых указаны в запросе.
    Если никакие контакты не были удалены, возвращается ошибка.

    Ожидаемые данные
    items (строка): Строка с перечислением ID контактов, которые нужно удалить, через запятую.

    Ответы:
    В случае успешного удаления возвращает JSON-ответ с ключом 'Status' и значением True, а также количеством удалённых объектов.

    Если не указаны все необходимые аргументы, возвращается JSON-ответ с ключом 'Status' и значением False, и сообщением об ошибке.

    Атрибуты:
    queryset:
    Не используется напрямую в этом классе. Запросы к базе данных формируются непосредственно в методах.

    serializer_class:
    Сериализатор ContactSerializer, используемый для преобразования данных контакта в формат JSON и для валидации данных при создании или обновлении контакта.


### AccountDetails (APIView): path: user/details
    Класс для управления деталями аккаунта пользователя. Позволяет просматривать и обновлять данные аутентифицированного пользователя.
    (Authorization Token: {auth_token})
    Методы:
    Метод GET:
    **get(request, *args, kwargs):
    Обрабатывает GET-запрос для получения деталей аутентифицированного пользователя.

    Ответы:
    В случае успешного получения данных возвращает JSON-ответ с деталями пользователя и HTTP-статус 200.

    Если пользователь не аутентифицирован, возвращает HTTP-статус 403 с сообщением 'Log in required'.

    Метод POST:
    **post(request, *args, kwargs):
    Обрабатывает POST-запрос для обновления деталей аутентифицированного пользователя. Поддерживает обновление пароля и других данных пользователя

    Ожидаемые данные:
        first_name: Имя пользователя
        last_name: Фамилия пользователя
        email: почта пользователz
        password: пароль
        company: компания
        position: должность

    Ответы:
        В случае успешного обновления данных возвращает JSON-ответ с ключом 'Status' и значением True.

    Если произошла ошибка при обновлении данных (например, ошибки валидации), возвращает JSON-ответ с ключом 'Status' и значением False, а также деталями ошибок.

    Атрибуты:
    queryset:
        Запрос к базе данных для получения данных пользователя не используется напрямую в этом классе. Вместо этого данные пользователя извлекаются непосредственно из объекта запроса request.user.

    serializer_class:
        Сериализатор UserSerializer, используемый для преобразования данных пользователя в формат JSON и для обновления данных пользователя.

## Shop class

### ShopView (ListAPIView): path: shops
    Класс для просмотра списка магазинов. Отображает только активные магазины.

    Методы:
    **get(request: Request, *args, kwargs):

    Атрибуты:
        queryset:
        Запрос к базе данных, который получает все записи из модели Shop, где state=True (только активные магазины).

        serializer_class:
        Сериализатор, используемый для преобразования объектов магазина в формат JSON (ShopSerializer).

### CategoryView (ListAPIView): path: categories
    Класс для просмотра списка категорий.

    Методы:
    **get(request: Request, *args, kwargs):

    Атрибуты:
        queryset:
        Запрос к базе данных, который получает все записи из модели Category.

        serializer_class:
        Сериализатор, используемый для преобразования объектов категории в формат 
        JSON (CategorySerializer).

### ProductInfoView (APIView): path: products
    Класс для поиска и отображения информации о продуктах. Поддерживает фильтрацию по магазинам и категориям.

    Методы:
    **get(request: Request, *args, kwargs):
    Возвращает информацию о продуктах на основе указанных фильтров (магазин и/или категория). Если фильтры не заданы, возвращаются все доступные продукты из активных магазинов.

    Параметры запроса:
    shop_id (int, optional): Идентификатор магазина для фильтрации продуктов.
    category_id (int, optional): Идентификатор категории для фильтрации продуктов.

    Ответ:
    200 OK:
    Список продуктов, соответствующих указанным фильтрам, в формате JSON.

    Атрибуты:
        query:
        Объект Q, который используется для создания динамических условий поиска.

        queryset:
        Запрос к базе данных, который получает информацию о продуктах, включая связанные модели (shop, product__category, product_parameters__parameter).

        serializer_class:
        Сериализатор, используемый для преобразования объектов ProductInfo в формат JSON (ProductInfoSerializer).


### BasketView (APIView): path: basket
    Класс для управления корзиной пользователя. Позволяет просматривать, добавлять, обновлять и удалять товары в корзине.

    Аутентификация: Все операции с корзиной требуют аутентификации.

    Методы:
    **get(request, *args, kwargs):
    Возвращает список товаров в корзине пользователя.

    **post(request, *args, kwargs):
    Добавляет товары в корзину пользователя.

        Ожидаемые данные:
        items (list): Список товаров, которые необходимо добавить в корзину.
        Каждый элемент должен содержать product_info (ID продукта) и quantity 
        (количество).
        Пример: 
            Authorization: Token {auth_token}: Токен авторизации пользователя.
            Content-Type: application/json: Тип контента запроса.
            body: 
            {
            "items": [
                {"product_info": 1, "quantity": 2}
                    ]
            }

    **put(request, *args, kwargs):
    Обновляет количество товаров в корзине пользователя.

        Ожидаемые данные:
        items (str): JSON-строка с информацией о товарах и их количестве для обновления.

    **delete(request, *args, kwargs):
    Удаляет товары из корзины пользователя.

        Ожидаемые данные:
        items (str): Строка с перечислением ID товаров, которые нужно удалить, через запятую.

### class OrderView(APIView): path: order
    Класс для управления заказами пользователя. Позволяет просматривать список заказов, создавать новый заказ, обновлять существующий и удалять заказ.
    (Authorization Token: {auth_token})

    Методы:
    **get(request, *args, kwargs):
    Обрабатывает GET-запрос для получения списка заказов аутентифицированного пользователя.

    Ответы:
    В случае успешного получения данных возвращает JSON-ответ с подробностями заказов и HTTP-статус 200.

    Если пользователь не аутентифицирован, возвращает HTTP-статус 403 с сообщением 'Log in required'.

    **post(request, *args, kwargs):
    Обрабатывает POST-запрос для размещения нового заказа из корзины.

    Ожидаемые данные:
    id: Идентификатор заказа (число).
    contact: Идентификатор контактных данных пользователя.

    Ответы:
    В случае успешного размещения заказа возвращает JSON-ответ с ключом 'Status' и значением True.

    Если произошла ошибка при обновлении данных (например, если указаны неверные аргументы), возвращает JSON-ответ с ключом 'Status' и значением False

    Если пользователь не аутентифицирован, возвращает HTTP-статус 403 с сообщением 'Log in required'.

    **put(request, *args, kwargs):
    Обрабатывает PUT-запрос для обновления существующего заказа.

    Ожидаемые данные:
    id: Идентификатор заказа (число).
    contact: (опционально) Идентификатор контактных данных для обновления.
    state: (опционально) Новое состояние заказа ('new', 'processing', 'shipped', 'delivered').

    Ответы:
    В случае успешного обновления возвращает JSON-ответ с ключом 'Status' и значением True, а также сообщением 'Order updated successfully'.

    Если указано недопустимое состояние заказа, возвращает JSON-ответ с ключом 'Status' и значением False, а также сообщением 'Invalid order state'.

    Если заказ не найден, возвращает HTTP-статус 404 с сообщением 'Order not found'

    Если пользователь не аутентифицирован, возвращает HTTP-статус 403 с сообщением 'Log in required'.

    **delete(request, *args, kwargs):**
    Обрабатывает DELETE-запрос для удаления указанного заказа пользователя.

    Ожидаемые данные:
    id: Идентификатор заказа (число).

    Ответы:
    В случае успешного удаления возвращает JSON-ответ с ключом 'Status' и значением True, а также сообщением 'Order deleted'.

    Если заказ находится в состоянии "корзина", возвращает JSON-ответ с ключом 'Status' и значением False, а также сообщением 'Cannot delete an active basket order'.

    Если заказ не найден, возвращает HTTP-статус 404 с сообщением 'Order not found'.

    Атрибуты:

    queryset:
        Запрос к базе данных для получения данных заказа не используется напрямую в этом классе. Вместо этого данные заказа извлекаются через методы `Order.objects.filter()` или `Order.objects.get()` в зависимости от контекста.
    
    serializer_class:
        Сериализатор OrderSerializer, используемый для преобразования данных заказа в формат JSON.


## Partner class
### PartnerUpdate (APIView): path: partner/update
    Класс для обновления информации о партнерах (магазинах) и их продуктах. Партнеры могут загружать данные о своем магазине и продуктах через YAML-файл.

    Аутентификация и авторизация: Пользователь должен быть аутентифицирован и иметь тип "shop". Если пользователь не аутентифицирован или его тип не "shop", операция будет отклонена.
    (Auth-Token: {auth_token}: Токен авторизации пользователя.)

    Валидация URL:
    Перед запросом URL проходит валидацию. Если URL некорректен, возвращается ошибка.

    Методы:
    **post(request, *args, kwargs):
    Обрабатывает POST-запрос для обновления информации о магазине и его продуктах. Данные берутся из YAML-файла, URL которого передается в теле запроса.

    Ожидаемые данные:
        url (str): URL-адрес YAML-файла, содержащего информацию о магазине, категориях и продуктах. 
        пример структуры файла:
        url: https://raw.githubusercontent.com/netology-code/pd-diplom/master/data/shop1.yaml

    Ответы:
        В случае успешного обновления возвращает HTTP-статус 200.

        Если URL некорректен, возвращает HTTP-статус 400 с сообщением 'Invalid URL'

        Если пользователь не аутентифицирован, возвращает HTTP-статус 403 с сообщением 'Log in required'
     
### PartnerState (APIView): path: partner/state
    Класс для управления статусом партнера (магазина). Позволяет просматривать текущий статус партнера и обновлять его.
    (Authorization Token: {auth_token})

    Методы:
    **get(request, *args, kwargs):
    Обрабатывает GET-запрос для получения текущего статуса партнера.

    Ответы:
    В случае успешного получения данных возвращает JSON-ответ с подробностями о статусе партнера и HTTP-статус 200.

    Если пользователь не аутентифицирован, возвращает HTTP-статус 403 с сообщением 'Log in required'.

    Если пользователь не является магазином (не имеет типа 'shop'), возвращает HTTP-статус 403 с сообщением 'Только для магазинов'.

    **post(request, *args, kwargs):
    Обрабатывает POST-запрос для обновления текущего статуса партнера.

    Ожидаемые данные:
    state: Новый статус партнера булево значение: True или False

    Ответы:
    В случае успешного обновления статуса возвращает JSON-ответ с ключом 'Status' и значением True.

    Если произошла ошибка при преобразовании значения состояния (например, некорректное значение), возвращает JSON-ответ с ключом 'Status' и значением False,
    а также деталями ошибки.

    Если не указано значение состояния, возвращает JSON-ответ с ключом 'Status' и значением False, а также сообщением 'Не указаны все необходимые аргументы'

    Если пользователь не является магазином (не имеет типа 'shop'), возвращает HTTP-статус 403 с сообщением

    Атрибуты:

    queryset:
    В данном классе запрос к базе данных для получения данных партнера не используется напрямую. Вместо этого данные партнера извлекаются через объект `request.user.shop`.

    serializer_class:
    Сериализатор `ShopSerializer`, используемый для преобразования данных партнера в формат JSON при обработке GET-запросов.

### class PartnerOrders(APIView): path: partner/orders
    Класс для получения заказов, связанных с аутентифицированным партнером (магазином).
    (Authorization Token: {auth_token})

    Методы:
    **get(request, *args, kwargs):
    Обрабатывает GET-запрос для получения списка заказов, связанных с аутентифицированным партнером (магазином).

    Ответы:
    В случае успешного получения данных возвращает JSON-ответ с подробностями заказов и HTTP-статус 200.

    Если пользователь не аутентифицирован, возвращает HTTP-статус 403 с сообщением 'Log in required'.

    Если пользователь не является магазином (не имеет типа 'shop'), возвращает HTTP-статус 403 с сообщением 'Только для магазинов'.

    Атрибуты:

    queryset:
        Запрос к базе данных для получения заказов не используется напрямую в этом классе. Вместо этого данные о заказах извлекаются через запросы к модели `Order`, фильтруя их по связанным товарам, принадлежащим магазину аутентифицированного пользователя.

    serializer_class:
        Сериализатор `OrderSerializer`, используемый для преобразования данных заказов в формат JSON.